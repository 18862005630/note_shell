### shell基础1 文件安全与权限

##### 1、创建一个文件(touch)
```

创建一个名为temp的文件 
touch temp

```

##### 2、查看当前目录下文件的属性(ls -l)
```
ls -l

结果显示:

总用量 36
-rw-r--r--    1 root     root            0 10月 19 20:16 temp

解释:

总用量36：是ls所列出的入口占用空间的字节数（以k为单位，千字节，即36k）
1：该文件硬链接的数目
root:文件属主
root:文件属组（一般是文件属主所在的缺省组）
0：字节（B）来表示的文件长度，记住，不是k字节，即0B
10月 19 20：16 ：文件更新时间
temp:文件名

-rw-r--r--:此为文件的权限位
总共10位，分两个部分，第一部分是第一位“-”，指定文件类型，第二部分为后9位，对应9个权限位，三位一组
rw-：前三位，文件属主可读写
r--：中三位，组用户可读
r--：后三位，其他用户可读

文件类型有7种：
d：目录
l：符号链接（指向另一个文件）
s：套接字文件
b：块设备文件
c：字符设备文件
p：命名管道文件
-：普通文件（常见）

文件权限位每组字符含三个权限位：
r：读权限
w：写、更改权限
x：执行该脚本或程序的权限

stat temp:可以查看更详情的文件属性


```

##### 3、使用chmod来改变权限位
```
这一命令有两种模式：（符号模式）（绝对模式）

1、符号模式格式：chmod [who] operator [permission] filename
who:
u：文件属主权限
g：属组用户权限
o：其他用户权限
a：所用用户

operator:
+：增加权限
-：取消权限
=：设定权限

permission：
r：读权限
w：写权限
x：执行权限
s：文件属主和组set-ID
t：粘性位*，使得文件只有文件拥有者可以删除文件(ROOT除外)，其他任何用户就算与拥有者拥有一样的权限都不能删除该文件
l：给文件加锁，使其他用户无法访问
i：不可修改权限
a：只追加权限，不可删减权限

example:
chmod a-x temp //rw- rw- rw- 收回所有用户的执行权限
chmod og-w temp //rw- r-- r- - 收回属组用户和其他用户的写权限
chmod g+w temp //rw- rw- r- - 赋予属组用户写权限
chmod u+x temp //rwx rw- r- - 赋予文件属主执行权限
chmod go+x temp //rwx rwx r- x 赋予属组用户和其他用户执行权限

2、绝对模式格式:chmod [mode] filename
mode:代表一个八进制数
0 4 0 0 文件属主可读
0 2 0 0 文件属主可写
0 1 0 0 文件属主可执行

0 0 4 0 属组用户可读
0 0 2 0 属组用户可写
0 0 1 0 属组用户可执行

0 0 0 4 其他用户可读
0 0 0 2 其他用户可写
0 0 0 1 其他用户可执行

简单计算法：
r w x
4+2+1
读：4
写：2
执行：1
最终权限数字为求和

例如:rwxr--r--等价于744

example:
chmod 666 rw- rw- rw- 赋予所有用户读和写的权限
chmod 644 rw- r-- r- - 赋予所有文件属主读和写的权限，所有其他用户读权限
chmod 744 rwx r-- r- - 赋予文件属主读、写和执行的权限，所有其他用户读的权限
chmod 664 rw- rw- r- - 赋予文件属主和属组用户读和写的权限，其他用户读权限
chmod 700 rwx --- --- 赋予文件属主读、写和执行的权限
chmod 444 r-- r-- r- - 赋予所有用户读权限

设置目录下所有文件的权限：
chmod 644*
设置连同子目录下所有文件的权限：
chmod -R 644 /temp/*
使用- R选项一定要谨慎，只有在需要改变目录树下全部文件权限时才可以使用。

```

##### 4、系统默认情况下建立文件与目录的权限
```

#vi /etc/bashrc 可以看到一般用户是002  root用户是022
说明：
一般用户默认建立文件权限是666-002=664，建立目录的权限是777-002=775
root默认建立文件权限是666-022=644，建立目录的权限是777-022=755

```

##### 5、目录权限
```
目录的权限位和文件有所不同。目录的读权限位意味着可以列出其中的内容。写权限位意味着可以在该目录中创建文件，如果不希望其他用户在你的目录中创建文件，可以取消相应的写权限位。执行权限位则意味着搜索和访问该目录.

r :可以列出该目录中的文件
w:可以在该目录中创建或删除文件
x:可以搜索或进入该目录

example:
drwx rwx r- x ( 775 ) 属主读、写、执行，属组读、写、执行，其它组读、执行
drwx r-x r- - ( 754 ) 属主读、写、执行，属组读、执行，其它组读
drwx r-x r- x ( 755 ) 属主读、写、执行，属组读、执行，其它组读、执行

如果把属组用户或其他用户针对某一目录的权限设置为- - x，那么他们将无法列出该目录中的文件。如果该目录中有一个执行位置位的脚本或程序，只要用户知道它的路径和文件名，仍然可以执行它。用户不能够进入该目录并不妨碍他的执行。

注意：目录的权限将会覆盖该目录中文件的权限。
如：
如果目录temp具有如下的权限： drwxr--r--  1   admin            0 10月 19 20:16 temp
而目录下的文件myfile的权限为：-rwxrwxrwx  1   admin           0 10月 19 20:16 myfile
那么admin组的用户将无法编辑该文件，因为它所属的目录不具有这样的权限。




```